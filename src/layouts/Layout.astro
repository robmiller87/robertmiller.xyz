---
import { ViewTransitions } from "astro:transitions";
import { SITE } from "@/config";
import "@/styles/global.css";
import Analytics from "@/components/Analytics.astro";

const googleSiteVerification = import.meta.env.PUBLIC_GOOGLE_SITE_VERIFICATION;

export interface Props {
  title?: string;
  author?: string;
  profile?: string;
  description?: string;
  ogImage?: string;
  canonicalURL?: string;
  pubDatetime?: Date;
  modDatetime?: Date | null;
  scrollSmooth?: boolean;
}

const {
  title = SITE.title,
  author = SITE.author,
  profile = SITE.profile,
  description = SITE.desc,
  ogImage = SITE.ogImage ? `/${SITE.ogImage}` : "/og.png",
  canonicalURL = new URL(Astro.url.pathname, Astro.url),
  pubDatetime,
  modDatetime,
  scrollSmooth = false,
} = Astro.props;

const socialImageURL = new URL(ogImage, Astro.url);

const structuredData = {
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  headline: `${title}`,
  image: `${socialImageURL}`,
  datePublished: `${pubDatetime?.toISOString()}`,
  ...(modDatetime && { dateModified: modDatetime.toISOString() }),
  author: [
    {
      "@type": "Person",
      name: `${author}`,
      ...(profile && { url: profile }),
    },
  ],
};

const personSchema = {
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "Robert Miller",
  "url": "https://robertmiller.xyz",
  "description": "Blockchain growth professional. Participated in crypto's first decentralized ICO (2017). Former VP Growth at Fuse Network. Building community infrastructure for the Startup Nation movement. Advising founders on positioning, capital, and the relationships that matter.",
  "sameAs": [
    "https://www.linkedin.com/in/rm16/",
    "https://twitter.com/rob_miller87",
    "https://x.com/rob_miller87",
    "https://www.instagram.com/je_suis_robert_miller/",
    "https://github.com/robmiller87",
    "https://t.me/robmiller"
  ],
  "jobTitle": "Founder & Advisor",
  "knowsAbout": ["Web3", "Growth Strategy", "Crypto Payments", "DeFi", "Founder Coaching", "Startups", "Network States", "Decentralized Finance", "Blockchain Infrastructure"],
  "alumniOf": [
    {"@type": "Organization", "name": "Monaize", "description": "First decentralized ICO in crypto history (2017)"},
    {"@type": "Organization", "name": "Fuse Network", "description": "L1/L2 payments blockchain"},
    {"@type": "Organization", "name": "Cointelegraph", "description": "Global crypto media"},
    {"@type": "Organization", "name": "Trustpilot"},
    {"@type": "Organization", "name": "Kronos (UKG)"},
    {"@type": "Organization", "name": "Jabmo"}
  ],
  "subjectOf": [
    // Fuse Era Articles (2021-2023)
    {"@type": "NewsArticle", "name": "The Future of Digital Payments Lies in Web3 Payment Services", "url": "https://news.bitcoin.com/the-future-of-digital-payments-lies-in-web3-payment-services-says-robert-miller-of-fuse/", "datePublished": "2023-05-13", "publisher": {"@type": "Organization", "name": "Bitcoin.com News"}},
    {"@type": "Article", "name": "Interview with Robert Miller, Marcom Director at Fuse", "url": "https://www.stakingrewards.com/journal/interview-with-robert-miller-marcom-director-at-fuse/", "datePublished": "2022-06", "publisher": {"@type": "Organization", "name": "Staking Rewards"}},
    {"@type": "Article", "name": "Learn & Earn: Fuse Network AMA", "url": "https://medium.com/krystaldefi/learn-earn-fuse-network-a1848baeed80", "datePublished": "2022-01-06", "publisher": {"@type": "Organization", "name": "Krystal DeFi"}},
    {"@type": "NewsArticle", "name": "Fuse Network Announces Formation of Independent FuseDAO", "url": "https://www.prnewswire.com/news-releases/payments-and-defi-centric-blockchain-fuse-network-announces-formation-of-independent-fusedao-ecosystem-development-body-301449176.html", "datePublished": "2021-12-21", "publisher": {"@type": "Organization", "name": "PR Newswire"}},
    {"@type": "Article", "name": "Fuse Dapps Now on DappRadar", "url": "https://dappradar.com/blog/fuse-dapps-now-on-dappradar", "datePublished": "2021-12-17", "publisher": {"@type": "Organization", "name": "DappRadar"}},
    // Monaize Era Articles (2017-2018) - First dICO in crypto history
    {"@type": "NewsArticle", "name": "Banking Meets Blockchain", "url": "https://cointelegraph.com/news/banking-meets-blockchain", "datePublished": "2017-10-30", "publisher": {"@type": "Organization", "name": "Cointelegraph"}},
    {"@type": "NewsArticle", "name": "Challenger Bank Monaize Partners Komodo Platform for First Ever Decentralized ICO", "url": "https://coinspeaker.com/challenger-bank-monaize-partners-komodo-platform-conduct-first-ever-decentralized-ico-dico/", "datePublished": "2017", "publisher": {"@type": "Organization", "name": "Coinspeaker"}},
    {"@type": "NewsArticle", "name": "Monaize Partners Komodo Launching Blockchain e-Banking Platform", "url": "https://www.financemagnates.com/cryptocurrency/news/monaize-partners-komodo-launching-blockchain-e-banking-platform/", "datePublished": "2017", "publisher": {"@type": "Organization", "name": "Finance Magnates"}},
    {"@type": "NewsArticle", "name": "Challenger Bank Monaize Brings Blockchain Technology In-House", "url": "https://nulltx.com/challenger-bank-monaize-brings-blockchain-technology-in-house-to-become-a-truly-hybrid-fintech-player/", "datePublished": "2018-06", "publisher": {"@type": "Organization", "name": "NullTX"}},
    {"@type": "NewsArticle", "name": "Monaize-Komodo Launch Decentralized Initial Coin Offering", "url": "https://www.newsbtc.com/sponsored/monaize-komodo-launch-decentralized-initial-coin-offering-cutting-middleman-icos-forever/", "datePublished": "2017", "publisher": {"@type": "Organization", "name": "NewsBTC"}},
    {"@type": "NewsArticle", "name": "Monaize Komodo Partner to Offer Blockchain Services", "url": "https://crypto.news/monaize-komodo-partner-offer-blockchain-services-on-banking-platform/", "datePublished": "2017", "publisher": {"@type": "Organization", "name": "Crypto News"}},
    // Fuse Era Videos (2021-2023)
    {"@type": "VideoObject", "name": "Fuse x Pocket Network AMA with the Founders", "url": "https://www.youtube.com/watch?v=mTrWJzk_Hvk", "thumbnailUrl": "https://img.youtube.com/vi/mTrWJzk_Hvk/maxresdefault.jpg", "uploadDate": "2021-08-19", "embedUrl": "https://www.youtube.com/embed/mTrWJzk_Hvk", "description": "AMA on decentralized infrastructure"},
    {"@type": "VideoObject", "name": "Know The Coin: Robert Miller Interview", "url": "https://www.youtube.com/watch?v=GmRUQvFis8k", "thumbnailUrl": "https://img.youtube.com/vi/GmRUQvFis8k/maxresdefault.jpg", "uploadDate": "2021-11-12", "embedUrl": "https://www.youtube.com/embed/GmRUQvFis8k", "description": "ChangeNOW interview series"},
    {"@type": "VideoObject", "name": "Fuse x Kolektivo AMA", "url": "https://www.youtube.com/watch?v=2nRo7WhbCYY", "thumbnailUrl": "https://img.youtube.com/vi/2nRo7WhbCYY/maxresdefault.jpg", "uploadDate": "2021-01-01", "embedUrl": "https://www.youtube.com/embed/2nRo7WhbCYY", "description": "Regenerative economies in Cura√ßao"},
    {"@type": "VideoObject", "name": "Fuse Meets Ramp Network", "url": "https://www.youtube.com/watch?v=nC8UdIddyvE", "thumbnailUrl": "https://img.youtube.com/vi/nC8UdIddyvE/maxresdefault.jpg", "uploadDate": "2022-06-28", "embedUrl": "https://www.youtube.com/embed/nC8UdIddyvE", "description": "Fiat on-ramp integration discussion"},
    {"@type": "VideoObject", "name": "BCTH2022: How Can Web3 Fix the Flaws of Our Digital Economy?", "url": "https://www.youtube.com/watch?v=ufycLXv87aQ", "thumbnailUrl": "https://img.youtube.com/vi/ufycLXv87aQ/maxresdefault.jpg", "uploadDate": "2022-01-01", "embedUrl": "https://www.youtube.com/embed/ufycLXv87aQ", "description": "Panel discussion in Thailand"},
    // Monaize Era Videos (2017) - Historic first dICO coverage
    {"@type": "VideoObject", "name": "Chico Crypto: Robert Miller of Monaize Interview Part 1", "url": "https://www.youtube.com/watch?v=dxTkLo64sy0", "thumbnailUrl": "https://img.youtube.com/vi/dxTkLo64sy0/maxresdefault.jpg", "uploadDate": "2017-10-01", "embedUrl": "https://www.youtube.com/embed/dxTkLo64sy0", "description": "Head of Monaize discussing first dICO"},
    {"@type": "VideoObject", "name": "Chico Crypto: Robert Miller of Monaize Interview Part 2", "url": "https://www.youtube.com/watch?v=gmmRBj8w9qc", "thumbnailUrl": "https://img.youtube.com/vi/gmmRBj8w9qc/maxresdefault.jpg", "uploadDate": "2017-10-22", "embedUrl": "https://www.youtube.com/embed/gmmRBj8w9qc", "description": "Talking Crypto with Robert Miller of Monaize and PTY Trader of Komodo"},
    {"@type": "VideoObject", "name": "Monaize Keynote: Banking Meets Blockchain Zurich", "url": "https://www.youtube.com/watch?v=Ko5KrN1O0m0", "thumbnailUrl": "https://img.youtube.com/vi/Ko5KrN1O0m0/maxresdefault.jpg", "uploadDate": "2017-11-08", "embedUrl": "https://www.youtube.com/embed/Ko5KrN1O0m0", "description": "Robert Miller (Head of UK) demo at Banking meets Blockchain event"},
    {"@type": "VideoObject", "name": "Monaize Live AMA", "url": "https://www.youtube.com/watch?v=1aZO-B3pfg4", "thumbnailUrl": "https://img.youtube.com/vi/1aZO-B3pfg4/maxresdefault.jpg", "uploadDate": "2017-11-01", "embedUrl": "https://www.youtube.com/embed/1aZO-B3pfg4", "description": "Live community AMA before first dICO"}
  ]
};
---

<!doctype html>
<html lang=`${SITE.lang ?? "en"}` class={`${scrollSmooth && "scroll-smooth"}`}>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <meta name="view-transition" content="same-origin" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="canonical" href={canonicalURL} />
    <meta name="generator" content={Astro.generator} />

    <!-- General Meta Tags -->
    <title>{title}</title>
    <meta name="title" content={title} />
    <meta name="description" content={description} />
    <meta name="author" content={author} />
    <link rel="sitemap" href="/sitemap-index.xml" />

    <!-- Open Graph / Facebook -->
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:image" content={socialImageURL} />

    <!-- Article Published/Modified time -->
    {
      pubDatetime && (
        <meta
          property="article:published_time"
          content={pubDatetime.toISOString()}
        />
      )
    }
    {
      modDatetime && (
        <meta
          property="article:modified_time"
          content={modDatetime.toISOString()}
        />
      )
    }

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={canonicalURL} />
    <meta property="twitter:title" content={title} />
    <meta property="twitter:description" content={description} />
    <meta property="twitter:image" content={socialImageURL} />

    <!-- Google JSON-LD Structured data -->
    <script
      type="application/ld+json"
      is:inline
      set:html={JSON.stringify(structuredData)}
    />

    <!-- Person Schema for SEO -->
    <script
      type="application/ld+json"
      is:inline
      set:html={JSON.stringify(personSchema)}
    />

    <!-- Enable RSS feed auto-discovery  -->
    <!-- https://docs.astro.build/en/recipes/rss/#enabling-rss-feed-auto-discovery -->
    <link
      rel="alternate"
      type="application/rss+xml"
      title={SITE.title}
      href={`${SITE.website}/rss.xml`}
    />

    <meta name="theme-color" content="" />

    <!-- Google Search Console Verification -->
    <meta name="google-site-verification" content="VoiGMepNR8TN73TfOsM0o1GUwq6JlhJ_GRMKGYhdbHI" />

    <ViewTransitions />

    <script is:inline src="/toggle-theme.js"></script>
    
    <!-- Twitter Widget Script -->
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
  </head>
  <body>
    <slot />
    <Analytics />
  </body>
</html>

<style>
  html,
  body {
    margin: 0;
    width: 100%;
    height: 100%;
  }
</style>
